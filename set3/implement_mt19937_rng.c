#include "crypt_helper.h"

const u32 TEST_MT_GEN_1234[] =
{
	0x31076b2f, 0x7f66e2d3, 0x9f428526, 0xd15ddc35, 0x700eeccc, 0x9cb35d74, 0xc90d4298, 0xc577d7f9,
	0xc7ac7e8f, 0xdc54dab1, 0x45c8a117, 0x269024e9, 0x46c65c9a, 0x32d2201e, 0xcd477eab, 0xd0ae849e,
	0xf5489eec, 0x28a81f7c, 0xe03d1f1a, 0x1dbb3576, 0x5b99e9ba, 0x34de878, 0x80413770, 0x7ca11ddc,
	0xaef76d45, 0x54bd6d50, 0xb673a3c9, 0xcd79c97f, 0x5ec8c0f6, 0x192709fe, 0x8faa8daf, 0xe559632,
	0x80ca0ef0, 0x715256fb, 0x386544c, 0x5ab3925, 0xc5d7f722, 0x4a6d2fa6, 0xe1f4c5fa, 0x3f13b4c3,
	0x5d692ae7, 0xbd005c8b, 0x9d8a9a80, 0xe3a452e9, 0x134c2f4b, 0xfcb52950, 0x5e6b4003, 0x1e10c502,
	0xeee24513, 0x64ceeb8c, 0xa6c0b7c1, 0x73e619cb, 0x65af1173, 0x89c40e6b, 0xc9ea37fa, 0xca6635d1,
	0x511c2c0e, 0x77410cf3, 0x916ee9c7, 0x6f71ef3c, 0xde7f21ea, 0x91c95a6b, 0x6fa90fae, 0xf8215b9c,
	0xcd598c51, 0xa61e357, 0x24cde70d, 0x8c519074, 0xb44a7260, 0x766b6b8c, 0xb45f70c5, 0x60607bfd,
	0x3802c271, 0x53f20bdf, 0xecc41fe5, 0xd0436e9f, 0x713022f9, 0xa58473fc, 0xe8c8ee59, 0xc242454,
	0xf4fa82d, 0xfeb58a10, 0x2f2d7029, 0xb071bf48, 0xc1f79b8, 0xedf6b8ec, 0xacc4ff46, 0xeb09afb8,
	0x98395456, 0xf9ad5fac, 0x888703da, 0x65a1ebd3, 0xb17492f, 0x433b76b1, 0x8fba1412, 0x6e1e6655,
	0x546526ae, 0xc3b849e2, 0x80c26f25, 0x9987f56d, 0x1ca51b26, 0x14b8f087, 0x9b710be4, 0xb45d06c3,
	0x90e1bf85, 0x29fcc6ee, 0x1bb4a2f, 0x8480bf6, 0x9e10a8f4, 0x5401a976, 0xe980e2af, 0x794ee38f,
	0xca5fca22, 0x116e000a, 0xfdf90d1c, 0x61f95404, 0xf5740852, 0x1e599067, 0xcabe2959, 0xe575c937,
	0x490634eb, 0xc3a9b94e, 0x9ffa8a97, 0x601a89b2, 0x7a645af9, 0x69bc23e, 0x3217c4b7, 0xe8126954,
	0x61df8e69, 0xc952ad00, 0xdcaaa79, 0x9e8b7162, 0x739f3af9, 0x362ab15a, 0xfb64a9a1, 0x4ad46f72,
	0x1fbab579, 0xa95afdf1, 0x1e8fbf15, 0xe2e1ffc7, 0xbd0fd8c4, 0xabd23877, 0x965987e7, 0x5465f5d1,
	0x78bce8fa, 0x3515a9b4, 0x1b6ca9c0, 0x2fa51d5, 0x3aae1174, 0x1250ab69, 0xe6641e72, 0xbae4f1a9,
	0x6ab05c01, 0xfad6c48e, 0x892d9303, 0xb0a4e71e, 0x196e18c, 0xfd964ff5, 0x4cf6dac9, 0xb0c6db6d,
	0x6fd83b13, 0xf2b8341a, 0x9cb5cbe0, 0x9569bc44, 0xeb0f077b, 0x8813dfe4, 0xa0304740, 0x2b2d2096,
	0xb4bc41b8, 0x28a79fd4, 0x265b8088, 0xf01e7eac, 0xbefe02f1, 0xb7e02f98, 0xd4bcdfde, 0x79feb2e9,
	0xa23bda0f, 0xe2371b48, 0x70351382, 0x6779cd90, 0x270f026b, 0x2be55482, 0x91834af2, 0x21bfbe4f,
	0x8739b4c3, 0x6972d02e, 0xf390d5e2, 0x65cf739, 0x7af8d1b7, 0x90458524, 0x80a7be58, 0xc82926a1,
	0x8970d979, 0x445e0aaa, 0xd1b73a02, 0x36d969d7, 0xe9f216d, 0x2d7460d4, 0xab5f3923, 0x6de45b12,
	0xc461c14c, 0xf8dc67c5, 0xb5470c75, 0xbe97e51, 0xcbff7cd0, 0xead7be08, 0x8ec969ed, 0x28afa44b,
	0xf741100f, 0xf1818714, 0x25ac1310, 0xc35e8dc0, 0x796f23d, 0xdcaf771, 0x98096760, 0x410b7e7e,
	0x1d3368d3, 0xed8f9d39, 0xf3684631, 0xd69b953e, 0x53618fb9, 0x282c34d3, 0x3190fe9b, 0xb0d6b157,
	0x753324e9, 0x5df033a3, 0xeb9f80a4, 0xeffe3654, 0xe10aad3d, 0x9d057a1c, 0x40ab6d01, 0xb308970b,
	0x59171abe, 0x80c115fd, 0x2ebe2291, 0xb60b5d1e, 0xe6dc1b26, 0x22671c62, 0xb4df0799, 0xd434e238,
	0xba0649e7, 0xbe2b2598, 0xe66c280c, 0x750029cc, 0xc7774760, 0x14401e08, 0x9962352f, 0x5f7ffb57,
	0x4a872f19, 0xef02caed, 0x26c1d715, 0x6b318c96, 0x55ce01ad, 0x3bf54a13, 0xa8555029, 0x928e5daf,
	0x12c693a4, 0x9275dbe7, 0xe14e627, 0x6ab97f91, 0x52bce527, 0xa039dfbb, 0x9729d0d2, 0x3869a97b,
	0xda9918a5, 0x9f3f4462, 0x497cec57, 0x7a48aff2, 0x2c4e2226, 0xf96e7b88, 0x224f36b6, 0xc5e25291,
	0xfea1a229, 0x6f28d2f, 0x2df39293, 0x3894ebab, 0x514abfac, 0x1ecdd623, 0x917b8baa, 0x2cdec194,
	0x264ab1a, 0x6df13159, 0xe690e86b, 0xa8638f97, 0xfa2c7e82, 0x90debae8, 0x8e90a641, 0x91ac46d9,
	0x15b3bd1b, 0xa77963ce, 0x553fa644, 0x5e59cbdb, 0xba7a4d3c, 0xf3cf7b6a, 0x2476a503, 0x325f8cd1,
	0x8d6e9aaf, 0xd99503bd, 0x45e629bf, 0xf5e09820, 0xf9788377, 0x6190f78d, 0xaaf41538, 0x54b83c30,
	0x41727e69, 0x42cbe13a, 0x1bba4d5e, 0xaa5d9fa3, 0xc6b3c7b9, 0x2e8a253c, 0xc8507a53, 0x6075f5f9,
	0xc2f87970, 0x3a672f5, 0xea165289, 0x56d1923c, 0xa89b80b2, 0x66bef733, 0x918089b1, 0x77b2e86a,
	0x33a642c7, 0xa6f062d1, 0xb2c38d04, 0xff47fbf7, 0xf3c31403, 0x8478687f, 0xe3d4a258, 0x6753162e,
	0xfe5a6e5e, 0xef65dfd, 0xd1968daf, 0xb91f23f, 0x8b8d2054, 0xa0885805, 0x738562d3, 0x210c57c,
	0xe3fb8e48, 0x6afa3348, 0xf927e1bf, 0x19fa6b8, 0x97e9ce0e, 0x6c98c951, 0x5db70ee3, 0x5cdf553c,
	0x52b65566, 0x9e68dd08, 0xdf159829, 0x6b43a2a1, 0x3733cb45, 0x38296d8, 0xbc255e3f, 0x69d1476d,
	0x5d993674, 0x38488f11, 0xcd35d3fe, 0x87a9ee01, 0xc8615c01, 0xc7987482, 0xb38c06b3, 0x858febed,
	0x9f6e494d, 0x8166eab4, 0x7e61fc72, 0x10b15b5d, 0xd72d7a8e, 0x6882ffed, 0xb64bfced, 0xb4065baf,
	0x71a404cb, 0xeca770c1, 0x7f1e69d, 0x8cd41a09, 0x5cfd47f4, 0x551b6a60, 0xbb109550, 0xa4a7cfb2,
	0x79bebb11, 0xf3b8641f, 0x582bb5fc, 0x36e42b5f, 0xa410bd7d, 0xe7a21bca, 0x204efdee, 0x8751ef8b,
	0x2be525a2, 0xc1eeb635, 0xbcb1b359, 0x85b95dd8, 0x2084ff98, 0x983185de, 0x5ea15fdf, 0x5eee15b7,
	0x9ab5a235, 0x150d3017, 0x1a650d7f, 0x87a8d4ba, 0xcd6864e0, 0xc2582f10, 0xf20fc6f6, 0x48d1b06,
	0xfaa249d1, 0x90ba9ce, 0xe1986fb9, 0xf1a68484, 0xa0afc32e, 0x67d361cb, 0xee345d86, 0x72a9b2d7,
	0xb98bd592, 0xc85ad3b0, 0xb77833a7, 0x92fe4c90, 0xa841fe2, 0xe05d7248, 0x7081e0ae, 0x5c423634,
	0x4835b9a8, 0x6d6324f3, 0x55c24bad, 0xd5761702, 0x156206bc, 0x1cb52b14, 0xc2c70267, 0xde6861d7,
	0x825fadca, 0xca95a5fb, 0xa93a674c, 0x7dde533a, 0xa15c4980, 0x6554ea2a, 0x5ef50f91, 0x91ce8b1,
	0x725d9010, 0x2bf3d3b0, 0x6a448850, 0x30653b51, 0x7afabdcc, 0x1a55a35f, 0xfbbb17ea, 0xe8b6ecbf,
	0x5f98b231, 0x95137e0f, 0x32d1a99, 0xe619cdd4, 0xec01db69, 0x6f5c4d99, 0xdf8f0545, 0x140fe932,
	0x5a0c146e, 0x39866e8f, 0xa1506754, 0xb2979ecd, 0x5b9a8c2e, 0x7fff5afb, 0x367b5e11, 0x81186780,
	0x392b72c3, 0xbf0a12a5, 0x6b688852, 0xe08eaa1e, 0x12aa3e9a, 0x38986d3c, 0xa69d63af, 0x4991b3c3,
	0xc174a5b3, 0xfe4693a5, 0xee9e2f84, 0xdc90da25, 0x605c05fa, 0x1bdd476b, 0x4c036d24, 0x5da59e50,
	0x5f37be05, 0x90c3bf36, 0xd3e41af7, 0x67daaeda, 0xe6b114bf, 0x842e0d3, 0x6d63c7ef, 0x2b5c174c,
	0x8f7c8c, 0x6e41de21, 0xabe3bfd, 0xc7ca8c55, 0x244c2d84, 0x6d5b2065, 0x99261269, 0xca38e9b1,
	0x1b40ff2e, 0x62d926b7, 0x4c129c66, 0xfaa65263, 0xef2c713, 0x382af3af, 0x9f0f256c, 0x17c55cfc,
	0x5ce632a, 0xf9b58fee, 0xdae4dd30, 0x49d0eafb, 0x4e6c1d6c, 0x5edebc5a, 0xc23fa1b0, 0xffb6c402,
	0x9032cc23, 0x859cb82e, 0x9c520a1, 0xd2afe1fc, 0x90c5b426, 0xd96caae1, 0xa8abeec3, 0xaf9059ae,
	0x2eea8b3a, 0x8ca77a5, 0xcc2325c6, 0xdb237f9, 0x9cc41ca2, 0x15a34576, 0x8e3f4cc6, 0xd0fc9729,
	0xa1265b9a, 0xea17e40a, 0xafa97f57, 0xb5b61118, 0x3d89b5c9, 0x984d60c, 0xc9b5a2bc, 0x87da9d01,
	0xdb421b5d, 0x5ea824b3, 0xba50d6f6, 0xa93dcc86, 0xb13d8812, 0x2420bbb2, 0x78ebfdad, 0xdc54a624,
	0xdb5c067a, 0x737ce759, 0xaa2c9e73, 0xfad2f32e, 0x5558202b, 0x8ac3ffcd, 0x84a52ee8, 0xaf00f037,
	0x650a4f95, 0xf0033e1e, 0x7f2ddce, 0x8bf4c061, 0x93abc6ba, 0x2a4acd7d, 0xd9aa1923, 0x7d1f49d1,
	0xf394c633, 0xb36e8230, 0xaed7b2de, 0x6b8809de, 0x137f6382, 0x2d74a9ad, 0x68fade3f, 0xc8267c00,
	0xaba0cdf, 0x8b0cd413, 0x2c978205, 0xc814b6a2, 0x90be2f9a, 0x97f2898f, 0x2c429886, 0x1bf2ce3f,
	0x910d627b, 0x2bd1566, 0x8395c866, 0x362b1d4, 0xde6e5291, 0x73b32750, 0xb868ad57, 0xfd0430d4,
	0xe751c32a, 0xa4ec941a, 0x4711c6db, 0x5254d9e1, 0x41b4d378, 0x29dd965e, 0xb31fc0d5, 0x37276cee,
	0xe6cd3819, 0xe3d710ac, 0xfbd3428d, 0xedc97a2d, 0xa412dcb6, 0x87aa32cb, 0x547b5d32, 0xe993a75e,
	0x9b4f112c, 0x27fbd858, 0xd279104a, 0xe028654c, 0xa0c25197, 0x597d5069, 0x1e30348a, 0xdb476e57,
	0x492f477d, 0xcd992a37, 0xfc9b773c, 0x5a5c90d3, 0x6e8a800f, 0xd53a839e, 0x930106c6, 0x5b7cea25,
	0x86f95636, 0xa320a6cb, 0x329963ef, 0x383fac4f, 0x2a6bde38, 0x489de406, 0x8040e935, 0x3123dc9,
	0xfd7e0361, 0x337676e9, 0x64dca5b2, 0xc3b3144a, 0xb6c992c1, 0x3a2f952e, 0x2d080ff9, 0x6332a541,
	0x12192505, 0x7d7b89d0, 0x2859fc82,
};

internal MIN_UNIT_TEST_FUNC(TestMt19937)
{
	mersenne_twister Mt;
	MtInitUnchecked(&Mt);

	MtSeed(&Mt, 1234);

	for (u32 ExtractedNumberIndex = 0;
		 ExtractedNumberIndex < ARRAY_LENGTH(TEST_MT_GEN_1234);
		 ++ExtractedNumberIndex)
	{
		u32 NextRandomNumber = MtExtractNumber(&Mt);
		MinUnitAssert(NextRandomNumber == TEST_MT_GEN_1234[ExtractedNumberIndex],
					  "Expected/Actual mismatch in TestMt19937.\nExpected: %x Actual: %x\n",
					  NextRandomNumber, TEST_MT_GEN_1234[ExtractedNumberIndex]);
	}
}

internal MIN_UNIT_TEST_FUNC(AllTests)
{
	MinUnitRunTest(TestMt19937);
}

int main()
{
	AllTests();
	printf("All tests passed!\nTests run: %d\n", MinUnitGlobalTestsRun);
}
